<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="pthreads : An effort to bring real threads to PHP5.3+" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>pthreads</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/krakjoe/pthreads">View on GitHub</a>

          <h1 id="project_title">pthreads</h1>
          <h2 id="project_tagline">An effort to bring real threads to PHP5.3+</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/krakjoe/pthreads/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/krakjoe/pthreads/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>What is supported ?</h1>

<p>As the name suggests, this extension is based on Posix Threads, as such Windows is unsupported. This will not change, I have no interest in working with the Windows API whatsoever.</p>

<h2>Project Goal</h2>

<p>The goal of this project is not to implement all of Posix Threads for PHP, but rather to provide PHP with it's own implementation of threading using Posix Threads. The geeks among us might like to see a full implementation of Posix Threads for PHP however I feel and have found that it will be much more useful to provide an implementation of threading that works rather than spending time writing bridges that cannot be crossed.</p>

<h2>What is required ?</h2>

<p>Just this source code and a thread safe version of PHP5.3+</p>

<p><strong>Please note: you MUST have a thread safe version of PHP for this to work</strong></p>

<h2>What do I need to know ?</h2>

<div class="highlight"><pre><span class="o">&lt;?</span><span class="nx">php</span>
<span class="k">class</span> <span class="nc">HelloWorld</span> <span class="k">extends</span> <span class="nx">Thread</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span><span class="nv">$myvar</span><span class="p">){</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">myvar</span> <span class="o">=</span> <span class="nv">$myvar</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">run</span><span class="p">(){</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$myvar</span><span class="p">){</span>
            <span class="nb">printf</span><span class="p">(</span>
                <span class="s2">"You passed %s as an argument and this is Thread #%lu</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> 
                <span class="nv">$myvar</span><span class="p">,</span> <span class="nx">Thread</span><span class="o">::</span><span class="na">self</span><span class="p">()</span>
            <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="nv">$thread</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">HelloWorld</span><span class="p">(</span><span class="s2">"Threading 101"</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$thread</span><span class="o">-&gt;</span><span class="na">start</span><span class="p">()){</span>
    <span class="nv">$thread</span><span class="o">-&gt;</span><span class="na">wait</span><span class="p">();</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>

<p>Threading in PHP should be and will be easy, and there's not much to know other than this:</p>

<ul>
<li>You cannot share resources or objects among threads</li>
<li>The run method has a special scope: anything you set as a member in your constructor is available in run() without referencing $this</li>
<li>Whatever run returns is returned when wait() is called, again, you cannot return resources or objects from run methods</li>
</ul>
<br />
<p>At first this might seem quite restrictive, with simplicity in mind: copying resources and class entries from other contexts is fraught with trouble, TSRM does a great job of keeping PHP thread safe, the implementation will be more stable if we do not ask it to do things that it simply doesn't want to do, like allow multiple threads to access the same resources concurrently. In the real world the above things actually just simplify usage and to a degree implementation. It's also worth mentioning that any function or method from any extension will run <strong>exactly</strong> the same inside a thread, which saves me a billion hours of testing and saves you from errors.</p>
<p>If you have read this far and are still thinking "but how will I send asynchronous MySQL queries if I cannot pass resources for a thread to use?", then frankly I am disappointed: the simplest solution is always the best ... I'll spell it out: you do not need to pass resources between threads because you can pass the parameters that create them and create the resources in the thread scope, in the case of MySQL you might even consider using persistent connections.</p>

<h3>Features</h3>
<p>Currently the following is implemented:</p>
<ul>
<li>Threads</li>
<li>Mutex</li>
<li>Conditions</li>
</ul>
<p>The following things are on my wish list:</p>
<ul>
  <li>Thread Groups - some methods to help manage arrays of threads basically, Threads::wait, Threads::start, Threads::busy etc</li>
  <li>Thread Scheduling  - some methods to help schedule threads to run in the future, possibly even after the current request is serviced</li>
</ul>
</section>
</div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">pthreads maintained by <a href="https://github.com/krakjoe">krakjoe</a></p>
      </footer>
    </div>

    

  </body>
</html>
